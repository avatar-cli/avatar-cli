# Avatar CLI

[![Pipeline Status]][Dev Commits] [![Latest Version]][crates.io] ![License]

## Introduction

Avatar-CLI is a statically-liked single-binary command line tool meant to ease
the development forkflow in many ways:
  - Making possible version-pinning for any kind of tool used in any kind of
    project. No need for complex setups or ultra-specific tools like
    [`nvm`](https://github.com/nvm-sh/nvm),
    [`nodenev`](https://ekalinin.github.io/nodeenv/),
    [`pyenv`](https://github.com/pyenv/pyenv),
    [`rbenv`](https://github.com/rbenv/rbenv),
    [`goenv`](https://github.com/syndbg/goenv),
    [`asdf-vm`](https://asdf-vm.com), ... I guess you already have seen the
    pattern.
  - Making possible for new contributors to be productive from the very first
    minute, reducing the bootstrap/setup time to almost zero. Only `git` and
    `docker` are required (in a way, not even `avatar-cli` is required! ðŸ˜‰).

## How to install Avatar-CLI

For now, Avatar-CLI is only available in its source code form, or via `cargo`.
The recommended way to install is is using this command:
```bash
cargo install avatar-cli
```

If you don't have `cargo` in your system, you can obtain it via
[rustup](https://rustup.rs/).

In future releases, pre-compiled binaries will be provided too.

## How to use Avatar-CLI

In the command line:
```bash
# 1. Enter into your project directory
cd /your/project/path

# 2. Initialize Avatar-CLI for this project, this will create a new config
#    file.
avatar init

# 3. Edit the generated configuration file, without modifying its
#    `internalProjectId` property. You can see an example in the next code
#    block of this text.

# 4. Now you can enter into an Avatar-CLI subshell and use all the configured
#    tools. If, for example, you configured a specific version of NodeJS, then
#    it will be available inside that subshell.
avatar shell

# Now you can use the software you specified in the configuration, even if it
# was not installed in your system.
```

Configuration example:
```yaml
---
# This is of no use... for now, but it must be there
version: '0.15.0'

# Keep the value generated by `avatar init`, don't share it across projects.
# This value is used (among other things) to keep track of managed volumes and
# containers
projectInternalId: v2ZmtbkGuVdvGwVE

# In this section we declare the OCI images that we'll use in our project
images:
  # Image name
  node:
    # Image tag
    14-buster:
      # The runConfig block allows us to tweak our containers, to improve their
      # integration with our development environment.
      runConfig:
        # You can specified hardcoded environment variables for your containers,
        # in this example we use this to configure NPM's cache
        env:
          npm_config_cache: /caches/.npm
        # You can pass host environment variables to your containers
        envFromHost:
          - NPM_TOKEN
        # You can specify which paths have to be mounted as volumes, this is
        # specially useful for package managers' caches
        volumes:
          "/caches/.npm": {}

      # For each image, we can declare which binaries we want to expose to our
      # project.
      binaries:
        node:
          path: node # The path can also be an absolute path

          # Although we don't do it in this example, each binary can have its
          # own `runConfig` block, and its values will override the ones defined
          # at the image tag level
        npm:
          path: npm
        npx:
          path: npx
        yarn:
          path: yarn

  # Image name
  rust:
    # Image tag
    1.45-stretch:
      binaries:
        cargo:
          path: cargo
```

## How to contribute

Read the [contributing guidelines](CONTRIBUTING.md).

## License

Avatar-CLI is licensed under the [GPL 3.0 license](LICENSE).

[crates.io]: https://crates.io/crates/avatar-cli
[Dev Commits]: https://gitlab.com/avatar-cli/avatar-cli/-/commits/dev
[License]: https://img.shields.io/crates/l/avatar-cli.svg
[Latest Version]: https://img.shields.io/crates/v/avatar-cli.svg
[Pipeline Status]: https://gitlab.com/avatar-cli/avatar-cli/badges/dev/pipeline.svg
